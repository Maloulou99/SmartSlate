<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css" th:href="@{/frontsite.css}" />
  <title>User Frontsite</title>
</head>
<body>
<h1>Welcome, <span th:text="${user.firstName}"></span> <span th:text="${user.lastName}"></span>!</h1>

<label>#UserID:</label>
<span th:text="${user.userID}"></span> <br/>

<label>UserName:</label>
<span th:text="${user.username}"></span> <br/>

<label>First name:</label>
<span th:text="${user.firstName}"></span> <br/>

<label>Last name:</label>
<span th:text="${user.lastName}"></span> <br/>

<label>Email:</label>
<span th:text="${user.email}"></span><br/>


<label>Phone Number:</label>
<span th:text="${user.phoneNumber}"></span> <br/>

<label>#RoleID:</label>
<span th:text="${user.roleID}"></span> <br/>

<a href="/projects/create">Create Project</a>
<a th:href="@{/smartslate/user/update/{userId}(userId=${user.userID})}">Update User</a>
<a th:href="@{/smartslate/deleteuser/{userId}(userId=${user.userID})}" onclick="return confirm('Are you sure you want to delete this user?')">Delete User</a>

<h2>User's Projects</h2>
<table>
  <tr>
    <th>Project ID</th>
    <th>Project Name</th>
    <th>Description</th>
    <th>Start Date</th>
    <th>End Date</th>
    <th>Budget</th>
    <th>Status</th>
    <th>Actions</th>
  </tr>
  <!-- <tr th:if="${projects.isEmpty()}">
    <td colspan="8">No projects found... Create a new project!</td>
  </tr>
  -->
  <tr th:each="project : ${projects}">
    <td th:text="${project.projectId}"></td>
    <td th:text="${project.projectName}"></td>
    <td th:text="${project.description}"></td>
    <td th:text="${project.startDate}"></td>
    <td th:text="${project.endDate}"></td>
    <td th:text="${project.budget}"></td>
    <td th:text="${project.status}"></td>
    <td>
      <a th:href="@{'/projects/edit/' + ${project.projectId}}">Edit</a>
      <a th:href="@{/projects/delete/{id}/{userid}(id=${project.projectId}, userid=${user.userID})}" onclick="return confirm('Are you sure you want to delete this project?')">Delete Project</a>
      <a th:href="@{'/projects/' + ${project.projectId} + '/createTask'}">Create Task</a>
    </td>
  </tr>
</table>


<!-- Display project tasks -->
<th:block th:if="${not #lists.isEmpty(tasks)}">
  <h2>Project's Tasks</h2>
  <table>
    <tr>
      <th>Task ID</th>
      <th>Project Name</th>
      <th>Description</th>
      <th>Deadline</th>
      <th>Assigned To</th>
      <th>Status</th>
    </tr>
    <tr th:if="${tasks.isEmpty()}">
      <td colspan="6">No tasks found... Create a new task!</td>
    </tr>
    <tr th:unless="${tasks.isEmpty()}" th:each="task : ${tasks}">
      <td th:text="${task.taskId}"></td>
      <td th:text="${task.project.projectName}"></td>
      <td th:text="${task.description}"></td>
      <td th:text="${task.deadline}"></td>
      <td th:text="${task.assignedTo}"></td>
      <td th:text="${task.status}"></td>
    </tr>
  </table>
</th:block>
</body>
</html>